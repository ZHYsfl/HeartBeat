# è…¾è®¯äº‘å¿«é€Ÿéƒ¨ç½²æŒ‡å— - è§£å†³ç½‘ç»œé—®é¢˜

## ðŸš¨ å½“å‰é—®é¢˜åˆ†æž

æ ¹æ®æ‚¨æä¾›çš„æœåŠ¡å™¨ä¿¡æ¯ï¼Œå‘çŽ°ä»¥ä¸‹é—®é¢˜ï¼š

1. **ç½‘ç»œè¿žæŽ¥é—®é¢˜**ï¼šæ— æ³•è¿žæŽ¥åˆ°å¤–éƒ¨é•œåƒæºå’ŒDNSè§£æžå¤±è´¥
2. **åŒ…æ›´æ–°å¤±è´¥**ï¼šapt update è¢«ä¸­æ–­ï¼Œæ— æ³•æ­£å¸¸æ›´æ–°ç³»ç»ŸåŒ…
3. **DNSè§£æžé—®é¢˜**ï¼šping baidu.com å¤±è´¥ï¼Œ100% ä¸¢åŒ…

## ðŸ”§ ç«‹å³è§£å†³æ–¹æ¡ˆ

### æ­¥éª¤1ï¼šä¿®å¤ç½‘ç»œå’ŒDNSé…ç½®

```bash
# 1. ä¸‹è½½å¹¶è¿è¡Œç½‘ç»œä¿®å¤è„šæœ¬
wget https://raw.githubusercontent.com/your-repo/heartbeat/main/fix-network.sh
chmod +x fix-network.sh
sudo ./fix-network.sh

# æˆ–è€…æ‰‹åŠ¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

# ä¿®å¤DNS
sudo tee /etc/systemd/resolved.conf > /dev/null <<EOF
[Resolve]
DNS=119.29.29.29 223.5.5.5 8.8.8.8
FallbackDNS=114.114.114.114 1.1.1.1
EOF

sudo systemctl restart systemd-resolved

# é…ç½®è…¾è®¯äº‘å†…ç½‘é•œåƒæº
sudo cp /etc/apt/sources.list /etc/apt/sources.list.backup
sudo tee /etc/apt/sources.list > /dev/null <<EOF
deb http://mirrors.tencentyun.com/ubuntu/ jammy main restricted universe multiverse
deb http://mirrors.tencentyun.com/ubuntu/ jammy-updates main restricted universe multiverse
deb http://mirrors.tencentyun.com/ubuntu/ jammy-backports main restricted universe multiverse
deb http://mirrors.tencentyun.com/ubuntu/ jammy-security main restricted universe multiverse
EOF

# æ¸…ç†å¹¶æ›´æ–°
sudo apt clean
sudo apt update
```

### æ­¥éª¤2ï¼šéªŒè¯ç½‘ç»œè¿žæŽ¥

```bash
# æµ‹è¯•DNS
nslookup baidu.com

# æµ‹è¯•ç½‘ç»œè¿žé€šæ€§
ping -c 3 119.29.29.29

# æµ‹è¯•é•œåƒæº
curl -I http://mirrors.tencentyun.com/ubuntu/
```

### æ­¥éª¤3ï¼šå®‰è£…Docker

ç½‘ç»œä¿®å¤åŽï¼Œè¿è¡ŒDockerå®‰è£…è„šæœ¬ï¼š

```bash
# ä¸‹è½½Dockerå®‰è£…è„šæœ¬
wget https://raw.githubusercontent.com/your-repo/heartbeat/main/install-docker.sh
chmod +x install-docker.sh
sudo ./install-docker.sh

# é‡æ–°ç™»å½•ä»¥ä½¿dockerç»„ç”Ÿæ•ˆ
newgrp docker
```

## ðŸš€ å¿«é€Ÿéƒ¨ç½²åº”ç”¨

ç½‘ç»œå’ŒDockerå®‰è£…å®ŒæˆåŽï¼š

### 1. ä¸Šä¼ é¡¹ç›®ä»£ç 

```bash
# æ–¹æ³•1ï¼šä½¿ç”¨gitå…‹éš†
git clone https://github.com/your-username/heartbeat.git
cd heartbeat

# æ–¹æ³•2ï¼šä½¿ç”¨scpä¸Šä¼ ï¼ˆä»Žæœ¬åœ°ï¼‰
# scp -r heartbeat/ ubuntu@your-server-ip:~/
```

### 2. é…ç½®çŽ¯å¢ƒå˜é‡

```bash
# å¤åˆ¶çŽ¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env.production

# ç¼–è¾‘é…ç½®æ–‡ä»¶
nano .env.production

# ç”ŸæˆJWTå¯†é’¥
python3 secret_key_gen.py
```

### 3. ä¸€é”®éƒ¨ç½²

```bash
# ç»™éƒ¨ç½²è„šæœ¬æ‰§è¡Œæƒé™
chmod +x deploy.sh

# è¿è¡Œéƒ¨ç½²è„šæœ¬
./deploy.sh
```

## ðŸ” æ•…éšœæŽ’é™¤

### å¦‚æžœä»ç„¶æ— æ³•è¿žæŽ¥ç½‘ç»œï¼š

1. **æ£€æŸ¥å®‰å…¨ç»„è®¾ç½®**ï¼š
   - ç¡®ä¿å¼€æ”¾äº†80ã€443ã€22ç«¯å£
   - æ£€æŸ¥å‡ºç«™è§„åˆ™æ˜¯å¦å…è®¸HTTP/HTTPS

2. **æ£€æŸ¥é˜²ç«å¢™**ï¼š
   ```bash
   sudo ufw status
   sudo ufw allow 80
   sudo ufw allow 443
   sudo ufw allow 22
   ```

3. **æ£€æŸ¥è·¯ç”±è¡¨**ï¼š
   ```bash
   ip route show
   ```

4. **é‡å¯ç½‘ç»œæœåŠ¡**ï¼š
   ```bash
   sudo systemctl restart networking
   sudo systemctl restart systemd-networkd
   ```

### å¦‚æžœDockerå®‰è£…å¤±è´¥ï¼š

1. **ä½¿ç”¨ç¦»çº¿å®‰è£…åŒ…**ï¼š
   ```bash
   # ä¸‹è½½Dockerç¦»çº¿åŒ…
   wget https://download.docker.com/linux/static/stable/x86_64/docker-20.10.21.tgz
   tar xzvf docker-20.10.21.tgz
   sudo cp docker/* /usr/bin/
   ```

2. **ä½¿ç”¨snapå®‰è£…**ï¼š
   ```bash
   sudo snap install docker
   ```

## ðŸ“ž èŽ·å–å¸®åŠ©

å¦‚æžœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œè¯·ï¼š

1. æ£€æŸ¥è…¾è®¯äº‘æŽ§åˆ¶å°çš„ç½‘ç»œé…ç½®
2. è”ç³»è…¾è®¯äº‘æŠ€æœ¯æ”¯æŒ
3. ç¡®è®¤æœåŠ¡å™¨æ˜¯å¦æœ‰å…¬ç½‘IP
4. æ£€æŸ¥VPCå’Œå­ç½‘é…ç½®

## ðŸŽ¯ é¢„æœŸç»“æžœ

ä¿®å¤å®ŒæˆåŽï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿï¼š
- âœ… æ­£å¸¸pingé€šå¤–éƒ¨ç½‘ç«™
- âœ… apt update æˆåŠŸæ‰§è¡Œ
- âœ… Dockeræ­£å¸¸å®‰è£…å’Œè¿è¡Œ
- âœ… åº”ç”¨æˆåŠŸéƒ¨ç½²å¹¶å¯è®¿é—®