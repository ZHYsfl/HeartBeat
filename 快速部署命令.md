# å¿ƒè·³æ‰“å¡åº”ç”¨ - å¿«é€Ÿéƒ¨ç½²å‘½ä»¤

## ğŸ‰ ç½‘ç»œå·²æ¢å¤æ­£å¸¸ï¼

ç°åœ¨å¯ä»¥å¼€å§‹æ­£å¼éƒ¨ç½²äº†ã€‚è¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ‰§è¡Œï¼š

## ğŸ“‹ éƒ¨ç½²æ­¥éª¤

### 1. æ›´æ–°ç³»ç»Ÿå¹¶å®‰è£…Docker

```bash
# æ›´æ–°ç³»ç»ŸåŒ…
sudo apt update && sudo apt upgrade -y

# å®‰è£…Dockerå’ŒDocker Compose
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# å®‰è£…Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose

# å°†ç”¨æˆ·æ·»åŠ åˆ°dockerç»„
sudo usermod -aG docker $USER

# é‡æ–°ç™»å½•ä»¥ä½¿ç»„æƒé™ç”Ÿæ•ˆ
newgrp docker

# éªŒè¯å®‰è£…
docker --version
docker-compose --version
```

### 2. ä¸Šä¼ é¡¹ç›®ä»£ç 

**æ–¹æ³•1ï¼šä½¿ç”¨Gitå…‹éš†ï¼ˆæ¨èï¼‰**
```bash
# å¦‚æœé¡¹ç›®å·²ä¸Šä¼ åˆ°GitHub
git clone https://github.com/your-username/heartbeat.git
cd heartbeat
```

**æ–¹æ³•2ï¼šä½¿ç”¨SCPä¸Šä¼ ï¼ˆä»æœ¬åœ°ï¼‰**
```bash
# åœ¨æœ¬åœ°Windows PowerShellä¸­æ‰§è¡Œ
scp -r d:\university\heartbeat ubuntu@your-server-ip:~/
```

**æ–¹æ³•3ï¼šæ‰‹åŠ¨åˆ›å»ºé¡¹ç›®ç»“æ„**
```bash
# åˆ›å»ºé¡¹ç›®ç›®å½•
mkdir -p ~/heartbeat
cd ~/heartbeat

# ç„¶åé€ä¸ªä¸Šä¼ æ–‡ä»¶ï¼Œæˆ–è€…ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºå¿…è¦æ–‡ä»¶
```

### 3. é…ç½®ç¯å¢ƒå˜é‡

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/heartbeat

# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env.production

# ç¼–è¾‘ç”Ÿäº§ç¯å¢ƒé…ç½®
nano .env.production

# éœ€è¦ä¿®æ”¹çš„å…³é”®é…ç½®ï¼š
# DATABASE_URL=postgresql://heartbeat:your_password@db:5432/heartbeat
# JWT_SECRET_KEY=your_generated_secret_key
# DOMAIN=your-domain.com æˆ–è€… your-server-ip
```

### 4. ç”ŸæˆJWTå¯†é’¥

```bash
# ç”Ÿæˆå®‰å…¨çš„JWTå¯†é’¥
python3 -c "import secrets; print(secrets.token_urlsafe(32))"

# æˆ–è€…ä½¿ç”¨é¡¹ç›®æä¾›çš„è„šæœ¬
python3 secret_key_gen.py
```

### 5. ä¸€é”®éƒ¨ç½²

```bash
# ç»™éƒ¨ç½²è„šæœ¬æ‰§è¡Œæƒé™
chmod +x deploy.sh

# è¿è¡Œéƒ¨ç½²è„šæœ¬
./deploy.sh

# æˆ–è€…æ‰‹åŠ¨æ‰§è¡ŒDocker Compose
docker-compose -f docker-compose.yml up -d
```

### 6. é…ç½®å®‰å…¨ç»„

åœ¨è…¾è®¯äº‘æ§åˆ¶å°é…ç½®å®‰å…¨ç»„ï¼Œå¼€æ”¾ä»¥ä¸‹ç«¯å£ï¼š
- **80** (HTTP)
- **443** (HTTPS) 
- **22** (SSH)

### 7. æµ‹è¯•è®¿é—®

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs

# æµ‹è¯•APIè®¿é—®
curl http://localhost/api/health

# æµ‹è¯•å‰ç«¯è®¿é—®
curl http://localhost/
```

## ğŸ”§ å¸¸ç”¨ç®¡ç†å‘½ä»¤

```bash
# æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# é‡å¯æœåŠ¡
docker-compose restart

# åœæ­¢æœåŠ¡
docker-compose down

# æ›´æ–°åº”ç”¨
git pull
docker-compose down
docker-compose up -d --build

# å¤‡ä»½æ•°æ®åº“
docker-compose exec db pg_dump -U heartbeat heartbeat > backup.sql
```

## ğŸŒ è®¿é—®åº”ç”¨

éƒ¨ç½²æˆåŠŸåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—®ï¼š

- **å‰ç«¯åº”ç”¨**: `http://your-server-ip/`
- **APIæ–‡æ¡£**: `http://your-server-ip/docs`
- **å¥åº·æ£€æŸ¥**: `http://your-server-ip/api/health`

## ğŸš¨ æ•…éšœæ’é™¤

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. **æ£€æŸ¥æœåŠ¡çŠ¶æ€**: `docker-compose ps`
2. **æŸ¥çœ‹é”™è¯¯æ—¥å¿—**: `docker-compose logs service-name`
3. **é‡å¯æœåŠ¡**: `docker-compose restart`
4. **æ£€æŸ¥ç«¯å£å ç”¨**: `netstat -tlnp | grep :80`
5. **æ£€æŸ¥é˜²ç«å¢™**: `sudo ufw status`

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœéœ€è¦å¸®åŠ©ï¼Œè¯·æä¾›ï¼š
- é”™è¯¯æ—¥å¿—è¾“å‡º
- æœåŠ¡è¿è¡ŒçŠ¶æ€
- ç³»ç»Ÿç¯å¢ƒä¿¡æ¯